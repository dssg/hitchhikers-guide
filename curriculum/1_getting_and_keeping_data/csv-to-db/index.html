<!doctype html><html lang="en" class="no-js"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="description" content="DSSG Hitchhikers guide"><meta name="lang:clipboard.copy" content="Copy to clipboard"><meta name="lang:clipboard.copied" content="Copied to clipboard"><meta name="lang:search.language" content="en"><meta name="lang:search.pipeline.stopwords" content="True"><meta name="lang:search.pipeline.trimmer" content="True"><meta name="lang:search.result.none" content="No matching documents"><meta name="lang:search.result.one" content="1 matching document"><meta name="lang:search.result.other" content="# matching documents"><meta name="lang:search.tokenizer" content="[\s\-]+"><link rel="shortcut icon" href="../../../assets/images/favicon.ico"><meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.3.1"><title>DSSG Hitchhickers guide</title><link rel="stylesheet" href="../../../assets/stylesheets/application.4031d38b.css"><link rel="stylesheet" href="../../../assets/stylesheets/application-palette.224b79ff.css"><meta name="theme-color" content="#ef5350"><script src="../../../assets/javascripts/modernizr.74668098.js"></script><link href="https://fonts.gstatic.com" rel="preconnect" crossorigin><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,400i,700|Ubuntu+Mono&display=swap"><style>body,input{font-family:"Ubuntu","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Ubuntu Mono","Courier New",Courier,monospace}</style><link rel="stylesheet" href="../../../assets/fonts/material-icons.css"></head><body dir="ltr" data-md-color-primary="red" data-md-color-accent="deep-orange"><svg class="md-svg"><defs><svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg></defs></svg> <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off"> <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off"> <label class="md-overlay" data-md-component="overlay" for="__drawer"></label><a href="#csvs-to-the-database" tabindex="1" class="md-skip">Skip to content </a><header class="md-header" data-md-component="header"><nav class="md-header-nav md-grid"><div class="md-flex"><div class="md-flex__cell md-flex__cell--shrink"><a href="../../.." title="DSSG Hitchhickers guide" class="md-header-nav__button md-logo"><i class="md-icon">bubble_chart</i></a></div><div class="md-flex__cell md-flex__cell--shrink"><label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label></div><div class="md-flex__cell md-flex__cell--stretch"><div class="md-flex__ellipsis md-header-nav__title" data-md-component="title"><span class="md-header-nav__topic">DSSG Hitchhickers guide</span><span class="md-header-nav__topic">CSVs to the Database</span></div></div><div class="md-flex__cell md-flex__cell--shrink"><label class="md-icon md-icon--search md-header-nav__button" for="__search"></label><div class="md-search" data-md-component="search" role="dialog"><label class="md-search__overlay" for="__search"></label><div class="md-search__inner" role="search"><form class="md-search__form" name="search"><input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active"> <label class="md-icon md-search__icon" for="__search"></label> <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">&#xE5CD;</button></form><div class="md-search__output"><div class="md-search__scrollwrap" data-md-scrollfix><div class="md-search-result" data-md-component="result"><div class="md-search-result__meta">Type to start searching</div><ol class="md-search-result__list"></ol></div></div></div></div></div></div><div class="md-flex__cell md-flex__cell--shrink"><div class="md-header-nav__source"><a href="https://github.com/dssg/hitchhikers-guide" title="Go to repository" class="md-source" data-md-source="github"><div class="md-source__icon"><svg viewBox="0 0 24 24" width="24" height="24"><use xlink:href="#__github" width="24" height="24"></use></svg></div><div class="md-source__repository">dssg/hitchhikers-guide</div></a></div></div></div></nav></header><div class="md-container"><main class="md-main"><div class="md-main__inner md-grid" data-md-component="container"><div class="md-sidebar md-sidebar--primary" data-md-component="navigation"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav class="md-nav md-nav--primary" data-md-level="0"><label class="md-nav__title md-nav__title--site" for="__drawer"><a href="../../.." title="DSSG Hitchhickers guide" class="md-nav__button md-logo"><i class="md-icon">bubble_chart</i></a>DSSG Hitchhickers guide</label><div class="md-nav__source"><a href="https://github.com/dssg/hitchhikers-guide" title="Go to repository" class="md-source" data-md-source="github"><div class="md-source__icon"><svg viewBox="0 0 24 24" width="24" height="24"><use xlink:href="#__github" width="24" height="24"></use></svg></div><div class="md-source__repository">dssg/hitchhikers-guide</div></a></div><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../.." title="Home" class="md-nav__link">Home</a></li><li class="md-nav__item"><a href="../../../what-is-dssg/" title="What is in this curriculum?" class="md-nav__link">What is in this curriculum?</a></li><li class="md-nav__item"><a href="../../../host-cities/" title="DSSG Locations" class="md-nav__link">DSSG Locations</a></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4"><label class="md-nav__link" for="nav-4">DSSG Manual (for summer fellows)</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-4">DSSG Manual (for summer fellows)</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../../dssg-manual/" title="What is in this manual" class="md-nav__link">What is in this manual</a></li><li class="md-nav__item"><a href="../../../dssg-manual/conduct-culture-and-communications/goals/" title="Goals of the Fellowship" class="md-nav__link">Goals of the Fellowship</a></li><li class="md-nav__item"><a href="../../../dssg-manual/conduct-culture-and-communications/environment/" title="The DSSG Environment" class="md-nav__link">The DSSG Environment</a></li><li class="md-nav__item"><a href="../../../dssg-manual/summer-overview/" title="Summer overview" class="md-nav__link">Summer overview</a></li><li class="md-nav__item"><a href="../../../dssg-manual/conduct-culture-and-communications/" title="Code of conduct" class="md-nav__link">Code of conduct</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5"><label class="md-nav__link" for="nav-5">Curriculum</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-5">Curriculum</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../" title="What is in this curriculum" class="md-nav__link">What is in this curriculum</a></li><li class="md-nav__item"><a href="../../sample/" title="Sample curriculum for Summer 2019" class="md-nav__link">Sample curriculum for Summer 2019</a></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-3" type="checkbox" id="nav-5-3"><label class="md-nav__link" for="nav-5-3">Skills you need throughout a project</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-5-3">Skills you need throughout a project</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../skills/ethics_bias_fairness/" title="Ethics, Bias, Fairness" class="md-nav__link">Ethics, Bias, Fairness</a></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-3-2" type="checkbox" id="nav-5-3-2"><label class="md-nav__link" for="nav-5-3-2">Communication</label><nav class="md-nav" data-md-component="collapsible" data-md-level="3"><label class="md-nav__title" for="nav-5-3-2">Communication</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../communication/" title="Intro" class="md-nav__link">Intro</a></li><li class="md-nav__item"><a href="../../communication/presentation-on-presentations.pdf" title="Presentations and communications" class="md-nav__link">Presentations and communications</a></li><li class="md-nav__item"><a href="../../communication/writing/" title="Writing reports" class="md-nav__link">Writing reports</a></li><li class="md-nav__item"><a href="../../eda/visualization/" title="Visualization" class="md-nav__link">Visualization</a></li><li class="md-nav__item"><a href="../../communication/user_interface/" title="User interface" class="md-nav__link">User interface</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-3-3" type="checkbox" id="nav-5-3-3"><label class="md-nav__link" for="nav-5-3-3">Software Practices</label><nav class="md-nav" data-md-component="collapsible" data-md-level="3"><label class="md-nav__title" for="nav-5-3-3">Software Practices</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../programming_best_practices/" title="Intro" class="md-nav__link">Intro</a></li><li class="md-nav__item"><a href="../../programming_best_practices/legible-good-code/" title="Legible, good code" class="md-nav__link">Legible, good code</a></li><li class="md-nav__item"><a href="../../programming_best_practices/test-test-test/" title="Writing tests" class="md-nav__link">Writing tests</a></li><li class="md-nav__item"><a href="../../programming_best_practices/reproducible-software/" title="Reproducible software" class="md-nav__link">Reproducible software</a></li><li class="md-nav__item"><a href="../../programming_best_practices/pimp-my-dotfiles/" title="Pimp my dotfiles!" class="md-nav__link">Pimp my dotfiles!</a></li></ul></nav></li><li class="md-nav__item"><a href="../../skills/domain_understanding/" title="Domain Understanding" class="md-nav__link">Domain Understanding</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-4" type="checkbox" id="nav-5-4"><label class="md-nav__link" for="nav-5-4">Project Scoping</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-5-4">Project Scoping</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../scoping/overview/" title="Scoping overview" class="md-nav__link">Scoping overview</a></li><li class="md-nav__item"><a href="../../scoping/project_workflow/" title="Project workflow" class="md-nav__link">Project workflow</a></li><li class="md-nav__item"><a href="../../scoping/dme/" title="Data Maturity evaluation" class="md-nav__link">Data Maturity evaluation</a></li><li class="md-nav__item"><a href="../../scoping/analysis_methods/" title="Intro to data analysis methods" class="md-nav__link">Intro to data analysis methods</a></li><li class="md-nav__item"><a href="../../scoping/deliverables/" title="Project deliverables" class="md-nav__link">Project deliverables</a></li></ul></nav></li><li class="md-nav__item"><a href="../../0_before_you_start/" title="Before you start" class="md-nav__link">Before you start</a></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-6" type="checkbox" id="nav-5-6"><label class="md-nav__link" for="nav-5-6">Tech setup</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-5-6">Tech setup</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../setup/you_need/" title="Software you need" class="md-nav__link">Software you need</a></li><li class="md-nav__item"><a href="../../setup/machines/" title="Setting up machines" class="md-nav__link">Setting up machines</a></li><li class="md-nav__item"><a href="../../setup/command-line-tools/" title="Command line intro" class="md-nav__link">Command line intro</a></li><li class="md-nav__item"><a href="../../setup/git/" title="Git and github basic" class="md-nav__link">Git and github basic</a></li><li class="md-nav__item"><a href="../../software/good_practices/" title="Good software practices" class="md-nav__link">Good software practices</a></li><li class="md-nav__item"><a href="../../software/basic_python/" title="Python" class="md-nav__link">Python</a></li><li class="md-nav__item"><a href="../../software/basic_sql/" title="SQL" class="md-nav__link">SQL</a></li><li class="md-nav__item"><a href="../../software/testing/" title="Software testing" class="md-nav__link">Software testing</a></li><li class="md-nav__item"><a href="../../setup/good_repos/" title="Good repos" class="md-nav__link">Good repos</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-7" type="checkbox" id="nav-5-7"><label class="md-nav__link" for="nav-5-7">Getting, storing, and linking data</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-5-7">Getting, storing, and linking data</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../" title="Intro" class="md-nav__link">Intro</a></li><li class="md-nav__item"><a href="../../get_data/security/" title="Data security" class="md-nav__link">Data security</a></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-7-3" type="checkbox" id="nav-5-7-3"><label class="md-nav__link" for="nav-5-7-3">Get data</label><nav class="md-nav" data-md-component="collapsible" data-md-level="3"><label class="md-nav__title" for="nav-5-7-3">Get data</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../get_data/scrapping/" title="APIs and scrapping" class="md-nav__link">APIs and scrapping</a></li><li class="md-nav__item"><a href="../../get_data/images/" title="Working with images" class="md-nav__link">Working with images</a></li><li class="md-nav__item"><a href="../../get_data/text/" title="Working with text" class="md-nav__link">Working with text</a></li><li class="md-nav__item"><a href="../../get_data/flat_files/" title="Flat files" class="md-nav__link">Flat files</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-7-4" type="checkbox" id="nav-5-7-4"><label class="md-nav__link" for="nav-5-7-4">Store data</label><nav class="md-nav" data-md-component="collapsible" data-md-level="3"><label class="md-nav__title" for="nav-5-7-4">Store data</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../store_data/etl/" title="ETL - cleaning, loading" class="md-nav__link">ETL - cleaning, loading</a></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-7-4-2" type="checkbox" id="nav-5-7-4-2"><label class="md-nav__link" for="nav-5-7-4-2">DBs</label><nav class="md-nav" data-md-component="collapsible" data-md-level="4"><label class="md-nav__title" for="nav-5-7-4-2">DBs</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../dbs/why/" title="Why a DB?" class="md-nav__link">Why a DB?</a></li><li class="md-nav__item"><a href="../../dbs/relational_design/" title="Designing a DB" class="md-nav__link">Designing a DB</a></li><li class="md-nav__item"><a href="../../dbs/getting_data_in/" title="Getting data in" class="md-nav__link">Getting data in</a></li><li class="md-nav__item"><a href="../../dbs/getting_data_out/" title="Getting data out" class="md-nav__link">Getting data out</a></li><li class="md-nav__item"><a href="../../software/sql_data_analysis/" title="Analyzing data (SQL)" class="md-nav__link">Analyzing data (SQL)</a></li></ul></nav></li><li class="md-nav__item"><a href="../../dbs/other_types/" title="Other types of DBs" class="md-nav__link">Other types of DBs</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-7-5" type="checkbox" id="nav-5-7-5"><label class="md-nav__link" for="nav-5-7-5">Link data</label><nav class="md-nav" data-md-component="collapsible" data-md-level="3"><label class="md-nav__title" for="nav-5-7-5">Link data</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../link_data/record_linkage/" title="Record linkage" class="md-nav__link">Record linkage</a></li></ul></nav></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-8" type="checkbox" id="nav-5-8"><label class="md-nav__link" for="nav-5-8">Data exploration</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-5-8">Data exploration</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../2_data_exploration_and_analysis/" title="Intro" class="md-nav__link">Intro</a></li><li class="md-nav__item"><a href="../../eda/intro/" title="Introduction to EDA" class="md-nav__link">Introduction to EDA</a></li><li class="md-nav__item"><a href="../../eda/visualization/" title="Visualization" class="md-nav__link">Visualization</a></li><li class="md-nav__item"><a href="../../software/sql_data_analysis/" title="SQL" class="md-nav__link">SQL</a></li><li class="md-nav__item"><a href="../../software/python_pandas/" title="pandas" class="md-nav__link">pandas</a></li><li class="md-nav__item"><a href="../../eda/gis/" title="GIS" class="md-nav__link">GIS</a></li><li class="md-nav__item"><a href="../../eda/text/" title="Text" class="md-nav__link">Text</a></li><li class="md-nav__item"><a href="../../eda/network/" title="Network" class="md-nav__link">Network</a></li><li class="md-nav__item"><a href="../../eda/tableau/" title="Tableau (?)" class="md-nav__link">Tableau (?)</a></li><li class="md-nav__item"><a href="../../eda/data_stories/" title="Data stories concept and code" class="md-nav__link">Data stories concept and code</a></li><li class="md-nav__item"><a href="../../eda/clustering/" title="ML as a data exploration tool (Clustering)" class="md-nav__link">ML as a data exploration tool (Clustering)</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-9" type="checkbox" id="nav-5-9"><label class="md-nav__link" for="nav-5-9">Computational and Data Analysis Methods</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-5-9">Computational and Data Analysis Methods</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../3_modeling_and_machine_learning/" title="Intro" class="md-nav__link">Intro</a></li><li class="md-nav__item"><a href="../../3_modeling_and_machine_learning/" title="Machine Learning" class="md-nav__link">Machine Learning</a></li><li class="md-nav__item"><a href="../../3_modeling_and_machine_learning/" title="Social Sciences" class="md-nav__link">Social Sciences</a></li><li class="md-nav__item"><a href="../../3_modeling_and_machine_learning/" title="Operations Research" class="md-nav__link">Operations Research</a></li><li class="md-nav__item"><a href="../../ml/methods/" title="Machine learning methods" class="md-nav__link">Machine learning methods</a></li><li class="md-nav__item"><a href="../../methods/causal_inference/" title="Causal inference methods" class="md-nav__link">Causal inference methods</a></li><li class="md-nav__item"><a href="../../methods/social_science/" title="Social science methods" class="md-nav__link">Social science methods</a></li><li class="md-nav__item"><a href="../../methods/statistical_analysis/" title="Other statistical analysis methods" class="md-nav__link">Other statistical analysis methods</a></li><li class="md-nav__item"><a href="../../methods/or/" title="OR/optimization methods" class="md-nav__link">OR/optimization methods</a></li></ul></nav></li><li class="md-nav__item"><a href="../../ml/templates/" title="Problem Templates in Social Good and Public Policy" class="md-nav__link">Problem Templates in Social Good and Public Policy</a></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-11" type="checkbox" id="nav-5-11"><label class="md-nav__link" for="nav-5-11">Practical Steps in Using Machine Learning to Solve Social Problems</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-5-11">Practical Steps in Using Machine Learning to Solve Social Problems</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-11-1" type="checkbox" id="nav-5-11-1"><label class="md-nav__link" for="nav-5-11-1">Building an ML Pipeline</label><nav class="md-nav" data-md-component="collapsible" data-md-level="3"><label class="md-nav__title" for="nav-5-11-1">Building an ML Pipeline</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../ml/pipeline.md" title="ML pipeline I" class="md-nav__link">ML pipeline I</a></li><li class="md-nav__item"><a href="../../ml/pipeline_ii/" title="ML pipeline II" class="md-nav__link">ML pipeline II</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-11-2" type="checkbox" id="nav-5-11-2"><label class="md-nav__link" for="nav-5-11-2">Set up problem</label><nav class="md-nav" data-md-component="collapsible" data-md-level="3"><label class="md-nav__title" for="nav-5-11-2">Set up problem</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../ml/problem_formulation/" title="ML problem formulation" class="md-nav__link">ML problem formulation</a></li><li class="md-nav__item"><a href="../../ml/checklist.md" title="ML Checklist" class="md-nav__link">ML Checklist</a></li><li class="md-nav__item"><a href="../../ml/templates/" title="Templates of policy problems" class="md-nav__link">Templates of policy problems</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-11-3" type="checkbox" id="nav-5-11-3"><label class="md-nav__link" for="nav-5-11-3">Labels/Outcomes</label><nav class="md-nav" data-md-component="collapsible" data-md-level="3"><label class="md-nav__title" for="nav-5-11-3">Labels/Outcomes</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../ml/labels/one_or_many/" title="One or many" class="md-nav__link">One or many</a></li><li class="md-nav__item"><a href="../../ml/labels/implications/" title="Implications of a label" class="md-nav__link">Implications of a label</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-11-4" type="checkbox" id="nav-5-11-4"><label class="md-nav__link" for="nav-5-11-4">Features/Predictors</label><nav class="md-nav" data-md-component="collapsible" data-md-level="3"><label class="md-nav__title" for="nav-5-11-4">Features/Predictors</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../ml/feature_engineering/intro/" title="Feature engineering" class="md-nav__link">Feature engineering</a></li><li class="md-nav__item"><a href="../../ml/feature_engineering/workshop/" title="Workshop on feature engineering" class="md-nav__link">Workshop on feature engineering</a></li><li class="md-nav__item"><a href="../../ml/feature_engineering/case_studies/" title="Case studies" class="md-nav__link">Case studies</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-11-5" type="checkbox" id="nav-5-11-5"><label class="md-nav__link" for="nav-5-11-5">Validation Methodology</label><nav class="md-nav" data-md-component="collapsible" data-md-level="3"><label class="md-nav__title" for="nav-5-11-5">Validation Methodology</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../ml/validation/process_and_goal/" title="Process and goal" class="md-nav__link">Process and goal</a></li><li class="md-nav__item"><a href="../../ml/validation/kfold/" title="K-fold cross-validation" class="md-nav__link">K-fold cross-validation</a></li><li class="md-nav__item"><a href="../../ml/validation/tcc/" title="Temporal cross-validation" class="md-nav__link">Temporal cross-validation</a></li><li class="md-nav__item"><a href="../../ml/validation/field_trials/" title="Field trials" class="md-nav__link">Field trials</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-11-6" type="checkbox" id="nav-5-11-6"><label class="md-nav__link" for="nav-5-11-6">Evalution Metrics</label><nav class="md-nav" data-md-component="collapsible" data-md-level="3"><label class="md-nav__title" for="nav-5-11-6">Evalution Metrics</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../ml/metrics/overview/" title="Overview" class="md-nav__link">Overview</a></li><li class="md-nav__item"><a href="../../ml/metrics/examples/" title="Examples" class="md-nav__link">Examples</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-11-7" type="checkbox" id="nav-5-11-7"><label class="md-nav__link" for="nav-5-11-7">Models/Methods</label><nav class="md-nav" data-md-component="collapsible" data-md-level="3"><label class="md-nav__title" for="nav-5-11-7">Models/Methods</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../ml/methods/" title="Machine learning methods" class="md-nav__link">Machine learning methods</a></li><li class="md-nav__item"><a href="../../ml/tips/" title="Practical tips on how to use them, parameters, etc." class="md-nav__link">Practical tips on how to use them, parameters, etc.</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-11-8" type="checkbox" id="nav-5-11-8"><label class="md-nav__link" for="nav-5-11-8">Model selection</label><nav class="md-nav" data-md-component="collapsible" data-md-level="3"><label class="md-nav__title" for="nav-5-11-8">Model selection</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../ml/selection/audition/" title="Audition" class="md-nav__link">Audition</a></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-11-8-2" type="checkbox" id="nav-5-11-8-2"><label class="md-nav__link" for="nav-5-11-8-2">What metrics do we care about?</label><nav class="md-nav" data-md-component="collapsible" data-md-level="4"><label class="md-nav__title" for="nav-5-11-8-2">What metrics do we care about?</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../ml/selection/performance/" title="Performance" class="md-nav__link">Performance</a></li><li class="md-nav__item"><a href="../../ml/selection/stability/" title="Stability" class="md-nav__link">Stability</a></li><li class="md-nav__item"><a href="../../ml/selection/interpretability/" title="Interpretability" class="md-nav__link">Interpretability</a></li><li class="md-nav__item"><a href="../../ml/selection/bias/" title="Bias" class="md-nav__link">Bias</a></li></ul></nav></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-11-9" type="checkbox" id="nav-5-11-9"><label class="md-nav__link" for="nav-5-11-9">Postmodeling</label><nav class="md-nav" data-md-component="collapsible" data-md-level="3"><label class="md-nav__title" for="nav-5-11-9">Postmodeling</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../ml/postmodeling/understanding/" title="Model understanding" class="md-nav__link">Model understanding</a></li><li class="md-nav__item"><a href="../../ml/postmodeling/feature_importance/" title="Feature importance" class="md-nav__link">Feature importance</a></li><li class="md-nav__item"><a href="../../ml/postmodeling/model_comparison/" title="Comparing different models" class="md-nav__link">Comparing different models</a></li><li class="md-nav__item"><a href="../../ml/postmodeling/list_comparison/" title="Comparing lists" class="md-nav__link">Comparing lists</a></li><li class="md-nav__item"><a href="../../ml/postmodeling/error_analysis/" title="Error analysis" class="md-nav__link">Error analysis</a></li><li class="md-nav__item"><a href="../../ml/postmodeling/bias_analysis/" title="Bias analysis" class="md-nav__link">Bias analysis</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-11-10" type="checkbox" id="nav-5-11-10"><label class="md-nav__link" for="nav-5-11-10">Experimental design</label><nav class="md-nav" data-md-component="collapsible" data-md-level="3"><label class="md-nav__title" for="nav-5-11-10">Experimental design</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../experimental_design/intro/" title="Experiment design" class="md-nav__link">Experiment design</a></li><li class="md-nav__item"><a href="../../experimental_design/case_studies/" title="Case studies" class="md-nav__link">Case studies</a></li></ul></nav></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-12" type="checkbox" id="nav-5-12"><label class="md-nav__link" for="nav-5-12">Deployment and Maintenance</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-5-12">Deployment and Maintenance</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../deployment/how_to/" title="How to deploy" class="md-nav__link">How to deploy</a></li><li class="md-nav__item"><a href="../../deployment/monitor/" title="Monitor" class="md-nav__link">Monitor</a></li><li class="md-nav__item"><a href="../../deployment/update/" title="Update" class="md-nav__link">Update</a></li><li class="md-nav__item"><a href="../../deployment/advanced_pipelines/" title="Advanced pipelines" class="md-nav__link">Advanced pipelines</a></li></ul></nav></li></ul></nav></li></ul></nav></div></div></div><div class="md-sidebar md-sidebar--secondary" data-md-component="toc"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav class="md-nav md-nav--secondary"><label class="md-nav__title" for="__toc">Table of contents</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="#motivation" title="Motivation" class="md-nav__link">Motivation</a></li><li class="md-nav__item"><a href="#tools" title="Tools" class="md-nav__link">Tools</a></li><li class="md-nav__item"><a href="#basic-database-lingo" title="Basic Database Lingo" class="md-nav__link">Basic Database Lingo</a></li><li class="md-nav__item"><a href="#lets-rock-some-data" title="Let's Rock Some Data!" class="md-nav__link">Let's Rock Some Data!</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#connecting-to-the-database" title="Connecting to the database" class="md-nav__link">Connecting to the database</a></li><li class="md-nav__item"><a href="#getting-data-into-a-database" title="Getting data into a Database" class="md-nav__link">Getting data into a Database</a></li><li class="md-nav__item"><a href="#step-1-lets-get-the-structure-of-the-data" title="Step 1: Let's get the structure of the data" class="md-nav__link">Step 1: Let's get the structure of the data</a></li><li class="md-nav__item"><a href="#lets-create-the-schema-and-table" title="Let's create the schema and table" class="md-nav__link">Let's create the schema and table</a></li><li class="md-nav__item"><a href="#step-2-lets-copy-the-data" title="Step 2: Let's copy the data" class="md-nav__link">Step 2: Let's copy the data</a></li><li class="md-nav__item"><a href="#step-3-lets-look-at-the-data-and-make-sure-everything-is-there" title="Step 3: Let's look at the data and make sure everything is there" class="md-nav__link">Step 3: Let's look at the data and make sure everything is there</a></li></ul></nav></li><li class="md-nav__item"><a href="#further-resources" title="Further Resources" class="md-nav__link">Further Resources</a></li><li class="md-nav__item"><a href="#discussion-notes" title="Discussion Notes" class="md-nav__link">Discussion Notes</a></li></ul></nav></div></div></div><div class="md-content"><article class="md-content__inner md-typeset"><h1 id="csvs-to-the-database">CSVs to the Database<a class="headerlink" href="#csvs-to-the-database" title="Permanent link">#</a></h1>
<h2 id="motivation">Motivation<a class="headerlink" href="#motivation" title="Permanent link">#</a></h2>
<p>This summer, you will use a database to store and analyze data. Databases have several advantages over using text files such as CSVs:</p>
<ul>
<li>Databases can store information about relationships between tables.</li>
<li>We're collecting more and more data -- often too much to fit in memory. Most databases can handle this. </li>
<li>Databases can provide integrity checks and guarantees. If you have a column of numbers in a spreadsheet, Excel will let you change a random cell to text. In contrast, you can tell your database to only accept input that meets your conditions (e.g. type, uniqueness). This is especially important for ongoing projects, where you have new data coming in.</li>
<li>Databases allow you to store data in one place. That makes updates easy and reliable. </li>
<li>Databases are more secure. You can more carefully control who has which types of access to what data better in a database than with a CSV.</li>
<li>Databases can handle multiple users. Concurrent edits to a CSV can get messy. Some file systems won't even let multiple users access a CSV at the same time.</li>
<li>Databases are designed to help you do analysis. SQL will probably become your best friend.</li>
</ul>
<p>You'll likely have to load CSVs into your database (e.g. from the open data portal), even if your partner gave a database dump (<a href="https://dsapp.uchicago.edu/home/resources/give-us-direct-access-system-database-dump/">which is ideal</a>). This session builds on what you learned last week in the <a href="https://github.com/dssg/hitchhikers-guide/tree/master/curriculum/0_before_you_start/pipelines-and-project-workflow">pipeline</a> and <a href="https://github.com/dssg/hitchhikers-guide/tree/master/curriculum/1_getting_and_keeping_data/command-line-tools">command line</a> sessions. We will focus on ETL. </p>
<h2 id="tools">Tools<a class="headerlink" href="#tools" title="Permanent link">#</a></h2>
<ul>
<li>psql (command line)</li>
<li>dBeaver</li>
<li>csvkit</li>
</ul>
<p>Notice that we're not using pandas. DO NOT COPY DATA INTO THE DATABASE USING PANDAS. We strongly recommend using <code>psql</code>, which is orders of magnitude faster.</p>
<h2 id="basic-database-lingo">Basic Database Lingo<a class="headerlink" href="#basic-database-lingo" title="Permanent link">#</a></h2>
<ul>
<li><em>Database server or host</em>: the computer on which the database is running. We will use Amazon RDS.</li>
<li><em>Database</em>: a self-contained set of tables and schema. A server can run many databases. This summer, we will operate databases for almost all projects from the same Amazon server.</li>
<li><em>Schema</em>: similar to a folder. A database can contain many schema, each containing many tables.</li>
<li><em>Tables</em>: tables are like spreadsheets. They have rows and columns and values in each cell.</li>
<li><em>Views</em>: views are virtual tables created by a query but only instantiated when the query is run. They can be used as tables but are generated "on-demand" when they're used. An advantage is that they always contain the most current data but take time to compute.</li>
<li><em>Queries</em>: Queries are analysis that you run on a database, often in SQL.</li>
</ul>
<h2 id="lets-rock-some-data">Let's Rock Some Data!<a class="headerlink" href="#lets-rock-some-data" title="Permanent link">#</a></h2>
<h3 id="connecting-to-the-database">Connecting to the database<a class="headerlink" href="#connecting-to-the-database" title="Permanent link">#</a></h3>
<p>Some unique aspects of the setup at DSSG: You cannot access the database server directly; you have to connect to the University's secure network and tunnel go through one of the EC2 instances. The data are far safer that way: you have to access the University's secure network, then one of our EC2s, and then the database. </p>
<p>There are two ways to connect to the database (once you're on the University network):</p>
<ol>
<li><em>Connect from your laptop</em>: Use an SSH tunnel to pass data between your laptop and the database. You have a database program running locally. If you're using dBeaver, you're connecting from your laptop.
<img alt="Connect from your laptop" src="https://www.lucidchart.com/publicSegments/view/0a5f49d0-d66c-4ef3-90eb-f7e037d20ec3/image.png" /></li>
<li><em>Connect from the EC2</em>: SSH into the EC2 and run everything from there. Your laptop only sends your commands to the EC2; the EC2 does the work. You don't use an SSH tunnel because everything stays on the EC2.
<img alt="Connect from the EC2" src="https://www.lucidchart.com/publicSegments/view/9ca0e0f9-da92-468a-935c-b1fc1d3d467a/image.png" /></li>
</ol>
<p>You can use option 1 (especially dBeaver) to explore the data, but you should use option 2 to load the data. First, downloading the datasets to your laptop may violate our contracts. Second, the internet connections will be better. The connections within Amazon are pretty fast; the connections from our office to Amazon might not be. Option 2 keeps the heavy transfers on Amazon's infrastructure. </p>
<h3 id="getting-data-into-a-database">Getting data into a Database<a class="headerlink" href="#getting-data-into-a-database" title="Permanent link">#</a></h3>
<p>There are three steps to get a CSV into an existing database:
1. <strong>Create table</strong>: This involves figuring out the structure of the table (how many fields, what should they be called, and what data types they are). Once you figure out the structure, you can create a sql "CREATE TABLE" statement and run that to generate an <em>empty</em> table*
2. <strong>Copy CSV to the table</strong>: Every database has a "bulk" copy command that is <strong>much</strong> more efficient than using pandas. Please do not use pandas to copy large csvs to a database. Postgres has a COPY command that can now copy your csv to the table you just created. 
3. <strong>Check if it copied successfully</strong>: You want to check if your table now has the same number of rows and columns as the CSV (as well as other consistency checks). If it did not copy successfully, you may need to modify the table structure, clean the csv to remove characters, replace nulls, and try steps 1 and 2 again.</p>
<h3 id="step-1-lets-get-the-structure-of-the-data">Step 1: Let's get the structure of the data<a class="headerlink" href="#step-1-lets-get-the-structure-of-the-data" title="Permanent link">#</a></h3>
<p>In this session, we will put the City of Chicago's food-inspection data into the DSSG training database.</p>
<p>Start by SSHing into the training server:
<code>ssh your_username@the_training_EC2_address</code></p>
<p>Create a folder for yourself in the EC2 training directory and download the data:</p>
<ol>
<li><code>cd /mnt/data/projects/training/</code></li>
<li><code>mkdir jwalsh</code></li>
<li><code>cd jwalsh</code></li>
<li><code>wget -O inspections.csv https://data.cityofchicago.org/api/views/4ijn-s7e5/rows.csv?accessType=DOWNLOAD</code></li>
</ol>
<p>This gives you a file called <code>inspections.csv</code>. You can explore the data using <code>head</code>, <code>tail</code>, <code>csvlook</code>, and other command-line tools you've learned in previous sessions.</p>
<p>Here's the output from <code>csvlook</code>:
<img alt="alt text" src="https://raw.githubusercontent.com/dssg/hitchhikers-guide/master/curriculum/1_getting_and_keeping_data/csv-to-db/inspections_data_csvlook.png" title="inspections data" /></p>
<p><code>csvsql</code> generates <code>create table</code> statements for you. Because it uses Python, it will load all the data and then do its thing. That can be really inefficient for large datasets: you have to wait to read the entire dataset, and you need lots of memory to do it. To limit the resources csvsql needs, I'll only use the first 1000 rows. We're using a PostgreSQL ("Postgres") database:</p>
<p><code>head -n1000 inspections.csv | csvsql -i postgresql</code></p>
<p>Here's the output:</p>
<div class="highlight"><pre><span></span>CREATE TABLE stdin (
    &quot;Inspection ID&quot; DECIMAL NOT NULL, 
    &quot;DBA Name&quot; VARCHAR NOT NULL, 
    &quot;AKA Name&quot; VARCHAR, 
    &quot;License #&quot; DECIMAL NOT NULL, 
    &quot;Facility Type&quot; VARCHAR, 
    &quot;Risk&quot; VARCHAR, 
    &quot;Address&quot; VARCHAR NOT NULL, 
    &quot;City&quot; VARCHAR NOT NULL, 
    &quot;State&quot; VARCHAR, 
    &quot;Zip&quot; DECIMAL NOT NULL, 
    &quot;Inspection Date&quot; DATE NOT NULL, 
    &quot;Inspection Type&quot; VARCHAR NOT NULL, 
    &quot;Results&quot; VARCHAR NOT NULL, 
    &quot;Violations&quot; VARCHAR, 
    &quot;Latitude&quot; DECIMAL, 
    &quot;Longitude&quot; DECIMAL, 
    &quot;Location&quot; VARCHAR
);
</pre></div>

<p>A few things to note:
* Inspection ID, DBA Name, AKA Name, etc. are column names.
* VARCHAR and INTEGER are column types. VARCHAR(11) means variable character length column up to 11 characters. If you try to give a character column a number, an integer column a decimal, and so on, Postgres will prevent the entire transfer. 
* NOT NULL means you have to provide a value for that column.
* Postgres hates uppercase and spaces in column names. If you have either, you need to wrap the column name in quotation marks. Yuck.
* We need to replace <code>stdin</code> with the table name (<code>jwalsh.jwalsh</code>). </p>
<p>Let's give it another shot:</p>
<p><code>head -n 1000 inspections.csv | tr [:upper:] [:lower:] | tr ' ' '_' | sed 's/#/num/' | csvsql -i postgresql --db-schema jwalsh --tables jwalsh</code></p>
<ul>
<li><code>tr [:upper:] [:lower:]</code> converts all uppercase to all lowercase. </li>
<li><code>tr ' ' '_'</code> converts all spaces to underscores.</li>
<li><code>sed 's/#/num/'</code> replaces the pound sign with "num".</li>
<li><code>csvsql -i postgresql --db-schema jwalsh --tables jwalsh</code> generates the postgres <code>create table</code> statement.</li>
</ul>
<p>Here's the output:</p>
<div class="highlight"><pre><span></span>CREATE TABLE jwalsh.jwalsh (
    inspection_id DECIMAL NOT NULL, 
    dba_name VARCHAR NOT NULL, 
    aka_name VARCHAR, 
    license_num DECIMAL NOT NULL, 
    facility_type VARCHAR, 
    risk VARCHAR, 
    address VARCHAR NOT NULL, 
    city VARCHAR NOT NULL, 
    state VARCHAR, 
    zip DECIMAL NOT NULL, 
    inspection_date DATE NOT NULL, 
    inspection_type VARCHAR NOT NULL, 
    results VARCHAR NOT NULL, 
    violations VARCHAR, 
    latitude DECIMAL, 
    longitude DECIMAL, 
    location VARCHAR
);
</pre></div>

<p><code>csvsql</code> ain't perfect. We could still make changes if we wanted, e.g. changing the <code>license_num</code> column type. But DECIMAL is good enough for this exercise. </p>
<h3 id="lets-create-the-schema-and-table">Let's create the schema and table<a class="headerlink" href="#lets-create-the-schema-and-table" title="Permanent link">#</a></h3>
<p>Remember, the schema is like a folder. You can use schema to categorize your tables. Let's use a script, which I'll call <code>inspections.sql</code>, to create the schema and table. Here's what it looks like:</p>
<div class="highlight"><pre><span></span>SET ROLE training_write;

CREATE SCHEMA IF NOT EXISTS jwalsh;

CREATE TABLE IF NOT EXISTS jwalsh.jwalsh (
    inspection_id DECIMAL NOT NULL, 
    dba_name VARCHAR NOT NULL, 
    aka_name VARCHAR, 
    license_num DECIMAL NOT NULL, 
    facility_type VARCHAR, 
    risk VARCHAR, 
    address VARCHAR NOT NULL, 
    city VARCHAR NOT NULL, 
    state VARCHAR, 
    zip DECIMAL NOT NULL, 
    inspection_date DATE NOT NULL, 
    inspection_type VARCHAR NOT NULL, 
    results VARCHAR NOT NULL, 
    violations VARCHAR, 
    latitude DECIMAL, 
    longitude DECIMAL, 
    location VARCHAR
);
</pre></div>

<p>A few things to note:
* The first row sets the role. You need to assume a role that has write permissions to create schemas and tables and to copy data.
* I added <code>IF NOT EXISTS</code> conditions for <code>create schema</code> and <code>create table</code>. You don't need those if you run the script once, but if you run the script multiple times, you'll get errors if those already exist.
* The <code>create table</code> statement is from above.</p>
<h3 id="step-2-lets-copy-the-data">Step 2: Let's copy the data<a class="headerlink" href="#step-2-lets-copy-the-data" title="Permanent link">#</a></h3>
<p>All you've given the database to this point is a schema and an empty table. Use psql's <code>\copy</code> command to get data into the table: <code>\copy [db table] from '[source CSV]' with csv header</code>. I'll add it to the <code>inspections.sql</code> script:
<div class="highlight"><pre><span></span>SET ROLE training_write;

CREATE SCHEMA IF NOT EXISTS jwalsh_schema;

CREATE TABLE jwalsh_schema.jwalsh_table (
        inspection_id DECIMAL NOT NULL,
        dba_name VARCHAR NOT NULL,
        aka_name VARCHAR,
        license_num DECIMAL NOT NULL,
        facility_type VARCHAR,
        risk VARCHAR, 
        address VARCHAR NOT NULL,
        city VARCHAR NOT NULL,
        state VARCHAR,  
        zip DECIMAL NOT NULL,
        inspection_date DATE NOT NULL,
        inspection_type VARCHAR NOT NULL,
        results VARCHAR NOT NULL,
        violations VARCHAR,
        latitude DECIMAL,
        longitude DECIMAL,
        location VARCHAR
);

\COPY jwalsh_schema.jwalsh_table from &#39;inspections.csv&#39; WITH CSV HEADER;
</pre></div></p>
<p>To run the script securely, follow these <a href="https://github.com/dssg/hitchhikers-guide/tree/master/curriculum/1_getting_and_keeping_data/data-security-primer">data security guidelines</a> by storing the database credentials in a file. Postgres looks for four environment variables: PGHOST, PGUSER, PGPASSWORD, and PGDATABASE. To set the environment variables using default_profile (copy and modify from <code>default_profile.example</code>):</p>
<p><code>eval $(cat default_profile)</code></p>
<p>Then
<code>psql -f inspections.sql</code></p>
<p>Uh oh, we got an error:
<div class="highlight"><pre><span></span>Password for user jwalsh: 
SET
psql:copy_example.sql:2: ERROR:  null value in column &quot;city&quot; violates not-null constraint
DETAIL:  Failing row contains (2145008, INTERURBAN, INTERURBAN, 2492070, Restaurant, Risk 1 (High), 1438 W CORTLAND ST , null, null, 60642, 2018-02-15, License, Pass, null, 41.916996072966775, -87.6645967198223, (41.916996072966775, -87.6645967198223)).
CONTEXT:  COPY jwalsh_table, line 7960: &quot;2145008,INTERURBAN,INTERURBAN,2492070,Restaurant,Risk 1 (High),1438 W CORTLAND ST ,,,60642,02/15/201...&quot;
</pre></div></p>
<p>With Postgres <code>copy</code>, either the entire copy is successful or none of it is. Check your table: nothing is there. I'll modify <code>inspections.sql</code> to allow missing values and try again:
<div class="highlight"><pre><span></span>SET ROLE training_write;

CREATE SCHEMA IF NOT EXISTS jwalsh_schema;

DROP TABLE IF EXISTS jwalsh_schema.jwalsh_table;

CREATE TABLE jwalsh_schema.jwalsh_table (
        inspection_id DECIMAL,
        dba_name VARCHAR,
        aka_name VARCHAR,
        license_num DECIMAL,
        facility_type VARCHAR,
        risk VARCHAR,
        address VARCHAR,
        city VARCHAR,
        state VARCHAR,
        zip DECIMAL,
        inspection_date DATE,
        inspection_type VARCHAR,
        results VARCHAR,
        violations VARCHAR,
        latitude DECIMAL,
        longitude DECIMAL,
        location VARCHAR
);

\COPY jwalsh_schema.jwalsh_table from &#39;inspections.csv&#39; WITH CSV HEADER;
</pre></div></p>
<p>Run the script:
<code>psql -f inspections.sql</code></p>
<h3 id="step-3-lets-look-at-the-data-and-make-sure-everything-is-there">Step 3: Let's look at the data and make sure everything is there<a class="headerlink" href="#step-3-lets-look-at-the-data-and-make-sure-everything-is-there" title="Permanent link">#</a></h3>
<p>Check if the data are there. Here's what it looks like in dBeaver:</p>
<p><img alt="alt text" src="https://raw.githubusercontent.com/dssg/hitchhikers-guide/master/curriculum/1_getting_and_keeping_data/csv-to-db/data_inserted_into_table.png" title="data inserted" /></p>
<h2 id="further-resources">Further Resources<a class="headerlink" href="#further-resources" title="Permanent link">#</a></h2>
<ul>
<li>Software Carpentry: <a href="http://swcarpentry.github.io/sql-novice-survey/">Databases and SQL</a></li>
</ul>
<h2 id="discussion-notes">Discussion Notes<a class="headerlink" href="#discussion-notes" title="Permanent link">#</a></h2></article></div></div></main><footer class="md-footer"><div class="md-footer-meta md-typeset"><div class="md-footer-meta__inner md-grid"><div class="md-footer-copyright">powered by <a href="https://www.mkdocs.org">MkDocs</a> and <a href="https://squidfunk.github.io/mkdocs-material/">Material for MkDocs</a></div><div class="md-footer-social"><link rel="stylesheet" href="../../../assets/fonts/font-awesome.css"> <a href="https://github.com/dssg/hitchhikers-guide" class="md-footer-social__link fa fa-github"></a>  <a href="https://twitter.com/datascifellows" class="md-footer-social__link fa fa-twitter"></a>  <a href="https://linkedin.com/company/center-for-data-science-and-public-policy-university-of-chicago" class="md-footer-social__link fa fa-linkedin"></a> </div></div></div></footer></div><script src="../../../assets/javascripts/application.b260a35d.js"></script><script>app.initialize({version:"1.0.4",url:{base:"../../.."}})</script><script src="../../../js/mermaid.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script></body></html>